ğŸ› ï¸ Build a complete Fleet Management Web Application using the following stack:

ğŸ”§ Tech Stack:
- Next.js (App Router) with TypeScript
- MongoDB with Mongoose
- Tailwind CSS for styling
- shadcn/ui or custom Tailwind UI
- Zod for all form validation
- Recharts for weekly vehicle profit/loss chart

---

ğŸš˜ Business Context:
I lease vehicles from two companies (PMV and Letzryd), assign 2 drivers per vehicle (morning/evening), and sublease to Uber drivers. I collect rent daily from drivers and pay the vehicle provider weekly based on trip slabs. I need to track daily trips, rent collected from drivers, rent payable to company (based on trip slabs), and calculate profit per vehicle every week.

---

ğŸ“¦ MongoDB Collections & Models:

1. `Vehicle`  
Fields:  
```ts
{
  vehicleNumber: string,
  company: "PMV" | "Letzryd",
  assignedDrivers: [ObjectId, ObjectId]
}
Driver
Fields:
{
  name: string,
  phone: string,
  hasAccommodation: boolean // true = â‚¹600/day, false = â‚¹500/day
}
Trip
Fields:
{
  driverId: ObjectId,
  vehicleId: ObjectId,
  tripDate: Date,
  shift: "morning" | "evening",
  tripCount: number
}
DriverRentLog
Fields:
{
  driverId: ObjectId,
  date: Date,
  rent: number,
  paid: boolean
}
SubstituteDriver (optional)
{
  name: string,
  vehicleId: ObjectId,
  date: Date,
  shiftHours: 6 | 8 | 12,
  charge: number // â‚¹250, â‚¹350, â‚¹500
}
WeeklySettlement
{
  vehicleId: ObjectId,
  weekStart: Date,
  weekEnd: Date,
  totalTrips: number,
  rentalRate: number,
  totalRentToCompany: number,
  driver1: { id: ObjectId, rent: number },
  driver2: { id: ObjectId, rent: number },
  totalDriverRent: number,
  profit: number,
  paid: boolean
}
ğŸ“Š Rental Slab Logic (Vehicle Rent You Pay):
âœ… Letzryd Weekly Slabs:
â‰¥140 trips â†’ â‚¹260/day
125â€“139 â†’ â‚¹380/day
110â€“124 â†’ â‚¹470/day
80â€“109 â†’ â‚¹600/day
65â€“79 â†’ â‚¹710/day
<65 â†’ â‚¹950/day
âœ… PMV Weekly Slabs:
â‰¥140 trips â†’ â‚¹150/day
135â€“139 â†’ â‚¹249/day
120â€“134 â†’ â‚¹444/day
80â€“119 â†’ â‚¹640/day
65â€“79 â†’ â‚¹750/day
<65 â†’ â‚¹949/day
â¡ï¸ Weekly Rent to Company = rentalRate Ã— 7
â¡ï¸ Slab calculation should return both rate and trips needed to reach the next lower slab
ğŸ’¸ Driver Rent (Your Income):
â‚¹600/day if hasAccommodation is true
â‚¹500/day if false
Tracked daily via DriverRentLog
Include a toggle button to mark as "Paid" or "Pending"
When clicked, the rent status should update and move the driver from â€œPendingâ€ to â€œPaidâ€ section
A separate section should show unpaid rents of all time (not just current week)
ğŸ“ˆ Profit Calculation (Weekly per Vehicle):
totalTrips = morningDriverTrips + eveningDriverTrips
rentalRate = based on trip slab
rentToCompany = rentalRate Ã— 7
rentFromDrivers = (500/600) Ã— 7 Ã— 2
profit = rentFromDrivers â€“ rentToCompany
Saved to WeeklySettlement collection
ğŸ“Š Weekly Dashboard Requirements:
âœ… Vehicle Selector Dropdown
âœ… Show weekly stats when a vehicle is selected:
Total Trips This Week
Current Rental Slab
How many trips needed for next cheaper slab
Rent payable to PMV/Letzryd
Driver 1 & 2 trip counts
Rent Pending per Driver
Button: Mark as Paid
Weekly Profit (color coded: green = profit, red = loss)
âœ… Global Rent Panel:
Section showing all unpaid rents across all drivers and vehicles
Sorted by date or driver
Helps admin follow up on outstanding dues
ğŸ“ˆ Recharts Bar Graph:
Compare weekly profit/loss per vehicle
x-axis: vehicleNumber
y-axis: profit in â‚¹
Color-coded bars (green: positive, red: loss)
Optional month/week selector
ğŸ”Œ Backend API Endpoints:
GET /api/vehicle/:id/weekly-summary
â†’ Get trip totals, rental rate, drivers, rent data
POST /api/driver/:id/rent-status
â†’ Toggle paid/pending for a driver rent log
GET /api/driver/unpaid-rents
â†’ List of all-time unpaid driver rents
POST /api/settlements
â†’ Trigger weekly profit calculation per vehicle
GET /api/dashboard/profit-graph
â†’ Vehicle-wise profit/loss data for chart
ğŸ“‚ File Structure:
/app/api/
/components/
   VehicleSelector.tsx
   VehicleSummaryCard.tsx
   DriverRentCard.tsx
   ProfitGraph.tsx
   UnpaidRentsPanel.tsx
   SettlementTrigger.tsx
/models/
   Vehicle.ts
   Driver.ts
   Trip.ts
   DriverRentLog.ts
   WeeklySettlement.ts
/lib/
   rentalUtils.ts (getRentalRate, getNextSlab)
âœ… Zod Validations:
Validate all forms for required fields, number ranges
Rent log form should validate date and amount
Trip count must be â‰¥ 0
Models include timestamps (createdAt, updatedAt)
ğŸ“ˆ Bonus Features (Optional):
Export weekly data to Excel or PDF
Admin login with NextAuth.js
SMS reminders for unpaid drivers
Substitute driver UI
ğŸ¯ Final Goal:
A full-featured admin dashboard for managing a sub-fleet business:
Tracks Uber trips
Calculates rental slabs dynamically
Collects rent from drivers
Pays rent to PMV/Letzryd based on weekly trip slabs
Shows driver-level rent status
Shows vehicle-level profit
Tracks all-time unpaid rents
Offers weekly performance graphs