ğŸš€ Build a full-stack Fleet Management Web Application using:

ğŸ”§ Tech Stack:
- Next.js (App Router) with TypeScript
- MongoDB (Mongoose)
- Tailwind CSS for styling
- shadcn/ui or custom Tailwind components for layout
- Zod for form validation
- Recharts for weekly profit visualization

---

ğŸ§  Business Context:
I run a fleet business by leasing vehicles from PMV and Letzryd. Each vehicle is operated by 2 Uber drivers per day (morning and evening shifts). Drivers log trips daily.  
I collect daily rent from drivers, pay rent weekly to the company based on the number of trips taken per vehicle, and calculate profit per vehicle weekly.  
If a driver takes leave, a **Substitute Driver** is provided on an hourly rental basis (6, 8, or 12 hours). I want to manage all of this via a responsive web dashboard.

---

## âœ… Core Features

### 1. Vehicle Management
- Fields: `vehicleNumber`, `company` ("PMV" or "Letzryd"), `assignedDrivers` [morningId, eveningId]

### 2. Driver Management
- Fields: `name`, `phone`, `hasAccommodation` (true/false)
- Daily driver rent:
  - â‚¹600/day (with accommodation)
  - â‚¹500/day (without accommodation)

### 3. Daily Trip Logging
- Fields: `driverId`, `vehicleId`, `tripDate`, `tripCount`, `shift` ("morning" or "evening")
- Logged daily via a form
- Automatically updates vehicleâ€™s weekly trip totals

### 4. Driver Rent Tracking
- Logged daily in `DriverRentLog`
- Paid/pending toggle
- Driver rent cards in dashboard
- Unpaid drivers tracked across **all time**, not just weekly

---

## ğŸ“¦ Rental Slab Logic

### Letzryd Weekly Trip Slabs:
- 140+ trips â†’ â‚¹260/day  
- 125â€“139 â†’ â‚¹380/day  
- 110â€“124 â†’ â‚¹470/day  
- 80â€“109 â†’ â‚¹600/day  
- 65â€“79 â†’ â‚¹710/day  
- <65 â†’ â‚¹950/day  

### PMV Weekly Trip Slabs:
- 140+ trips â†’ â‚¹150/day  
- 135â€“139 â†’ â‚¹249/day  
- 120â€“134 â†’ â‚¹444/day  
- 80â€“119 â†’ â‚¹640/day  
- 65â€“79 â†’ â‚¹750/day  
- <65 â†’ â‚¹949/day  

â¡ï¸ Rent to company = slabRate Ã— 7

---

## âœ… 5. Substitute Driver Management (NEW âœ…)
> Used when regular driver takes urgent leave

### Charges:
- 6 hours â†’ â‚¹250  
- 8 hours â†’ â‚¹350  
- 12 hours â†’ â‚¹500

### Fields:
- `name`, `vehicleId`, `date`, `shift` ("morning" or "evening"), `shiftHours` (6, 8, or 12), `charge`

### Validation:
- shiftHours must be 6, 8, or 12
- charge must exactly match allowed hourly pricing
- Prevent multiple substitutes in same shift/day/vehicle

---

## âœ… 6. Weekly Settlement & Profit Calculation

### Formula:
```ts
driverRentTotal = driver1Rent + driver2Rent
substituteCharges = sum of all substitute driver charges this week
totalIncome = driverRentTotal + substituteCharges
rentToCompany = rentalSlab Ã— 7
weeklyProfit = totalIncome - rentToCompany
â¡ï¸ Data saved to WeeklySettlement collection
ğŸ§¾ MongoDB Collections
Vehicle
{ vehicleNumber, company, assignedDrivers }
Driver
{ name, phone, hasAccommodation }
Trip
{ driverId, vehicleId, tripDate, shift, tripCount }
DriverRentLog
{ driverId, date, rent, paid }
SubstituteDriver âœ…
{
  name: string,
  vehicleId: ObjectId,
  date: Date,
  shift: "morning" | "evening",
  shiftHours: 6 | 8 | 12,
  charge: 250 | 350 | 500
}
WeeklySettlement
{
  vehicleId,
  weekStart,
  weekEnd,
  totalTrips,
  rentalRate,
  totalRentToCompany,
  driver1: { id, rent },
  driver2: { id, rent },
  substituteDriverCharges,
  totalDriverRent,
  profit,
  paid
}
ğŸ§± Folder Structure
/app/api/
/models/
  Vehicle.ts
  Driver.ts
  Trip.ts
  DriverRentLog.ts
  WeeklySettlement.ts
  SubstituteDriver.ts âœ…
/lib/
  rentalUtils.ts (getRentalRate, getNextSlabTier)
/components/
  VehicleSelector.tsx
  VehicleSummaryCard.tsx
  DriverRentCard.tsx
  SubstituteDriverForm.tsx âœ…
  SubstituteList.tsx âœ…
  ProfitGraph.tsx
  UnpaidRentsPanel.tsx
ğŸ”Œ Required API Routes
POST /api/trips/log
POST /api/driver/:id/rent-status (toggle paid/pending)
POST /api/substitute-drivers âœ…
GET /api/substitute-drivers?week=... âœ…
POST /api/settlements/run (calculate and save profit)
GET /api/vehicle/:id/weekly-summary
GET /api/driver/unpaid-rents
GET /api/dashboard/profit-graph
ğŸ“Š Dashboard Components
Vehicle Summary (Dropdown View)
Total trips
Rental rate (based on trip slab)
â€œX more trips needed to get to better rateâ€
Rent payable to PMV/Letzryd
Substitute driver cost this week âœ…
Rent collected from both drivers
Total profit/loss this week
Driver Rent Cards
Driver name, trip count
Rent pending â†’ toggle to â€œPaidâ€
Paid drivers move to history
Unpaid driver rents shown across lifetime âœ…
Substitute Driver Section âœ…
Name, date, shift, hours, charge
List shown per vehicle/week
Added into income automatically
Recharts Graph (Weekly Profit)
Bar chart: vehicle vs profit â‚¹
Filter by week/month
Color-coded for profit/loss
âœ… Form Validation (Zod)
All forms (trip log, driver rent, substitutes) validated using Zod
Validate numeric inputs, shift values, allowed ranges
createdAt and updatedAt timestamps in all schemas
â›³ Development Steps
Scaffold backend models in models/
Build trip entry + driver rent log forms
Add substitute driver entry form âœ…
Write logic to calculate weekly rent slabs
Run profit calculation & store weekly summaries
Build dashboard with all summaries and toggles
Integrate Recharts profit graph
Add filter/search by week/month
Optional: Export data to Excel
ğŸ¯ Final Goal:
Build a clean, mobile-friendly web app that:
Tracks daily Uber trips and rent
Calculates vehicle-wise rent slab based on trips
Logs substitute driver shifts on demand
Shows weekly rent, income, and profit
Displays long-term unpaid rent cases
Graphs performance across all vehicles